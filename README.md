The body of the code comes from mxnet1.4.1